#!/usr/bin/env bash
# Build or rebuild an Emacs-Plus installation
# https://github.com/d12frosted/homebrew-emacs-plus

setopt -euo pipefail

brew install gcc libgccjit || brew upgrade gcc libgccjit
brew tap d12frosted/emacs-plus
brew install emacs-plus@28 --with-native-comp --build-from-source ||
  brew reinstall emacs-plus@28 --with-native-comp --build-from-source
# Should be a symlink
rm ~/Applications/Emacs.app
ln -s /usr/local/opt/emacs-plus@28/Emacs.app ~/Applications
# rm -rf ~/.emacs.d/{eln-cache,straight}
